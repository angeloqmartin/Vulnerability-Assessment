# Vulnerability Assessment

This repository aims to provide comprehensive information and resources on Vulnerability Assessment, encompassing key topics in security assessments, vulnerability scoring, essential tools like Nessus and OpenVAS, Splunk and reporting mechanisms.

## Table of Contents

1. [Security Assessments](#security-assessments)
2. [Vulnerability Scoring and Reporting](#vulnerability-scoring-and-reporting)
3. [Nessus](#nessus)
4. [OpenVAS](#openvas)
5. [Reporting](#reporting)

---

## Security Assessments

Security assessments are crucial for organizations, allowing them to identify and address vulnerabilities in their networks, systems, and applications. These assessments help in compliance evaluation, risk mitigation, and improving cybersecurity posture.

Vulnerability assessments differ from penetration tests. They focus on checklist-based evaluations and validation of critical vulnerabilities, while penetration tests involve comprehensive manual and automated techniques, showcasing real-world attack scenarios.

Regular vulnerability assessments, aligned with industry standards like GDPR or OWASP, confirm vulnerabilities without delving into advanced exploitation techniques. Organizations might choose these assessments periodically or opt for more comprehensive penetration tests to identify broader security issues.

Beyond vulnerability assessments and penetration tests, organizations might require other security assessments based on specific needs.

While vulnerability assessments are internally initiated, security audits are mandated by external entities to ensure compliance with regulations such as PCI DSS for credit card acceptance.

Conducting vulnerability assessments proactively is crucial for organizations to maintain compliance before facing surprise security audits mandated by external entities.

### Methodology

Below is a sample vulnerability assessment methodology:

8 Steps To Performing A Network Vulnerability Assessment

1. **Conduct Risk Identification And Analysis**: Identify assets that are a part of an information system.
2. **Develop Vulnerability Scanning Policies**: The policies should have an official owner and be approved by management.
3. **Identify The Type Of Scans**: Depending on the system it needs to be determined the type of scan to be preformed.
4. **Configure The Scan**: To configure a vulnerability scan define, targets, ports and protocols, etc.
5. **Perform The Scan**: Scanning tools will fingerprint the specified targets to gather basic information.
6. **Evaluate And Consider Possible Risks**: Risks associated with scan pertain mostly to the availability of the target system.
7. **Interpret The Scan Results**: Give priority to vulnerability.
8. **Create A Remediation & Mitigation Plan**: Information security staff should prioritize the mitigation of each vulnerability.

## Vulnerability Scoring and Reporting

### Common Vulnerability Scoring System (CVSS) & Common Vulnerabilities and Exposures (CVE)

In cybersecurity, determining the severity of vulnerabilities involves using standards like the [Common Vulnerability Scoring System (CVSS)](https://www.first.org/cvss/). While scanning tools automatically apply these scores, understanding the methodology behind them is crucial for manual assessments or justifications of assigned scores.CVSS is often complemented by Microsoft's DREAD, an assessment system aiding in evaluating threat severity. DREAD employs a 10-point scale, focusing on five key factors:
1. Damage Potential
2. Reproducibility
3. Exploitability
4. Affected Users
5. Discoverability

### Calculating CVSS Severity

The CVSS v3.1 calculator can be found [here](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator) and the equations can be seen defined below. 

**Base**

The Base Score is a function of the Impact and Exploitability sub score equations. Where the Base score is defined as,

    If (Impact sub score <= 0)     0 else,
    Scope Unchanged4               𝑅𝑜𝑢𝑛𝑑𝑢𝑝(𝑀𝑖𝑛𝑖𝑚𝑢𝑚[(𝐼𝑚𝑝𝑎𝑐𝑡 + 𝐸𝑥𝑝𝑙𝑜𝑖𝑡𝑎𝑏𝑖𝑙𝑖𝑡𝑦), 10])
    Scope Changed                  𝑅𝑜𝑢𝑛𝑑𝑢𝑝(𝑀𝑖𝑛𝑖𝑚𝑢𝑚[1.08 × (𝐼𝑚𝑝𝑎𝑐𝑡 + 𝐸𝑥𝑝𝑙𝑜𝑖𝑡𝑎𝑏𝑖𝑙𝑖𝑡𝑦), 10])

and the Impact sub score (ISC) is defined as,

    Scope Unchanged 6.42 × 𝐼𝑆𝐶Base
    Scope Changed 7.52 × [𝐼𝑆𝐶𝐵𝑎𝑠𝑒 − 0.029] − 3.25 × [𝐼𝑆𝐶𝐵𝑎𝑠𝑒 − 0.02]15

Where,

    𝐼𝑆𝐶𝐵𝑎𝑠𝑒 = 1 − [(1 − 𝐼𝑚𝑝𝑎𝑐𝑡𝐶𝑜𝑛𝑓) × (1 − 𝐼𝑚𝑝𝑎𝑐𝑡𝐼𝑛𝑡𝑒𝑔) × (1 − 𝐼𝑚𝑝𝑎𝑐𝑡𝐴𝑣𝑎𝑖𝑙)]

 And the Exploitability sub score is,

    8.22 × 𝐴𝑡𝑡𝑎𝑐𝑘𝑉𝑒𝑐𝑡𝑜𝑟 × 𝐴𝑡𝑡𝑎𝑐𝑘𝐶𝑜𝑚𝑝𝑙𝑒𝑥𝑖𝑡𝑦 × 𝑃𝑟𝑖𝑣𝑖𝑙𝑒𝑔𝑒𝑅𝑒𝑞𝑢𝑖𝑟𝑒𝑑 × 𝑈𝑠𝑒𝑟𝐼𝑛𝑡𝑒𝑟𝑎𝑐𝑡𝑖𝑜𝑛

**Temporal**

The Temporal score is defined as,

    𝑅𝑜𝑢𝑛𝑑𝑢𝑝(𝐵𝑎𝑠𝑒𝑆𝑐𝑜𝑟𝑒 × 𝐸𝑥𝑝𝑙𝑜𝑖𝑡𝐶𝑜𝑑𝑒𝑀𝑎𝑡𝑢𝑟𝑖𝑡𝑦 × 𝑅𝑒𝑚𝑒𝑑𝑖𝑎𝑡𝑖𝑜𝑛𝐿𝑒𝑣𝑒𝑙 × 𝑅𝑒𝑝𝑜𝑟𝑡𝐶𝑜𝑛𝑓𝑖𝑑𝑒𝑛𝑐𝑒)

**Environmental**

The environmental score is defined as,

    If (Modified Impact Sub score <= 0)     0 else,

    If Modified Scope is Unchanged          Round up(Round up (Minimum [ (M.Impact + M.Exploitability) ,10]) × Exploit Code Maturity × Remediation Level × Report Confidence)
    
    If Modified Scope is Changed            Round up(Round up (Minimum [1.08 × (M.Impact + M.Exploitability) ,10]) × Exploit Code Maturity × Remediation Level × Report Confidence)

And the modified Impact sub score is defined as,

    If Modified Scope is Unchanged 6.42 × [𝐼𝑆𝐶𝑀𝑜𝑑𝑖𝑓𝑖𝑒𝑑]
    
    If Modified Scope is Changed 7.52 × [𝐼𝑆𝐶𝑀𝑜𝑑𝑖𝑓𝑖𝑒𝑑 − 0.029]-3.25× [𝐼𝑆𝐶𝑀𝑜𝑑𝑖𝑓𝑖𝑒𝑑 × 0.9731 − 0.02] 13

Where,

    𝐼𝑆𝐶𝑀𝑜𝑑𝑖𝑓𝑖𝑒𝑑 = 𝑀𝑖𝑛𝑖𝑚𝑢𝑚 [[1 − (1 − 𝑀. 𝐼𝐶𝑜𝑛𝑓 × 𝐶𝑅) × (1 − 𝑀. 𝐼𝐼𝑛𝑡𝑒𝑔 × 𝐼𝑅) × (1 − 𝑀. 𝐼𝐴𝑣𝑎𝑖𝑙 × 𝐴𝑅)], 0.915]

The Modified Exploitability sub score is,

    8.22 × 𝑀. 𝐴𝑡𝑡𝑎𝑐𝑘𝑉𝑒𝑐𝑡𝑜𝑟 × 𝑀. 𝐴𝑡𝑡𝑎𝑐𝑘𝐶𝑜𝑚𝑝𝑙𝑒𝑥𝑖𝑡𝑦 × 𝑀. 𝑃𝑟𝑖𝑣𝑖𝑙𝑒𝑔𝑒𝑅𝑒𝑞𝑢𝑖𝑟𝑒𝑑 × 𝑀. 𝑈𝑠𝑒𝑟𝐼𝑛𝑡𝑒𝑟𝑎𝑐𝑡𝑖𝑜n
    
4 Where “Round up” is defined as the smallest number, specified to one decimal place, that is equal to or higher than its input. For example, Round up (4.02) is 4.1; and Round up (4.00) is 4.0.

### Common Vulnerabilities and Exposures (CVE)

[The Common Vulnerabilities and Exposures (CVE)](https://cve.mitre.org) serves as a comprehensive repository of security issues. Each security concern is assigned a unique CVE ID by the CVE Numbering Authority (CNA) to ensure standardized identification of vulnerabilities or exposures discovered by researchers.

A CVE entry comprises vital details regarding a vulnerability or exposure, including descriptive information and references relevant to the issue. This detailed information empowers an organization's IT team to comprehend the potential impact of a problem on their environment.

Assigning a CVE ID to a vulnerability follows specific criteria:

- The vulnerability must be independently fixable.
- It should impact a single codebase.
- The issue needs acknowledgment and documentation by the relevant vendor.

Stages of Obtaining a CVE

**Stage 1: Identify if CVE is Required and Relevant**
-  Identify if the issue found is a vulnerability. According to the CVE Team, "A vulnerability in the context of the CVE Program is indicated by code that can be exploited, resulting in a negative impact to confidentiality, integrity, OR availability, and that requires a coding change, specification change, or specification deprecation to mitigate or address." Additionally, research should verify there is not a CVE ID already in the CVE database.

**Stage 2: Reach Out to Affected Product Vendor**
-  A researcher should ensure they have made a good faith effort to contact a vendor directly. Researchers can reference CVE's [Documents on Disclosure Practices](https://www.cve.org/ReportRequest/ReportRequestForNonCNAs) for additional information.

**Stage 3: Identify if Request Should Be For Vendor CNA or Third Party CNA**
-  If a company is a part of participating CNA's, they can assign a CVE ID for one of their products. If the issue is for a participating CNA, researchers can contact the appropriate CNA organization [here](https://www.cve.org/ReportRequest/ReportRequestForNonCNAs). If the vendor is not a participating CNA, a researcher should attempt to reach out to the vendor's third-party coordinator.

**Stage 4: Requesting CVE ID Through CVE Web Form**
-  The CVE Team has a form that can be filled out online [here](https://cveform.mitre.org) if the methods above do not work for CVE requests.

**Stage 5: Confirmation of CVE Form**
-  Upon submitting the CVE Web Form mentioned in Stage 4, an individual will receive a confirmation email. The CVE team will contact the requestor if any additional information is required.

**Stage 6: Receival of CVE ID**
-  Upon approval, the CVE Team will notify the requestor of a CVE ID if the affected product's vulnerability is confirmed. Please note that the CVE ID is not public yet at this stage.

**Stage 7: Public Disclosure of CVE ID**
-  CVE IDs can be announced to the public as soon as appropriate vendors and parties are aware of the issue to prevent duplication of CVE IDs. This stage ensures that all associated parties are aware of the problem before being publicly disclosed.

**Stage 8: Announcing the CVE**
-  The CVE Team asks researchers who are sharing multiple CVEs to ensure each CVE indicates the different vulnerabilities. Additional information can be found [here](https://www.cve.org/ReportRequest/ReportRequestForNonCNAs).

**Stage 9: Providing Information to The CVE Team**
-  At this stage, the CVE Team asks that the researcher help provide additional information to be used in the official CVE listing on the website. The U.S. [National Vulnerability Database (NVD)](https://nvd.nist.gov) maintains this information online in their database as well.

## Nessus

[Nessus](https://www.tenable.com/products/nessus) is a widely used vulnerability scanner that identifies vulnerabilities, misconfigurations, and other security issues within networks and systems. It performs comprehensive scans and provides detailed reports, aiding in vulnerability management and remediation.

To download Nessus, we can navigate to its [Download Page](https://www.tenable.com/downloads/nessus?loginAttempted=true) to download the correct Nessus binary for our system.

**Installing Package**


```console
$ dpkg -i Nessus-8.15.1-ubuntu910_amd64.deb
```

Once Nessus has been installed, start the Nessus Service:

```consol
$ sudo systemctl start nessusd.service
```



Perfrom a basic scan on all port on the specfied target 

https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/758d03a1-5e15-492b-b20c-f581d5783bc0


http://localhost:8834

## OpenVAS

[OpenVAS](https://www.openvas.org/) (Open Vulnerability Assessment System) is an open-source vulnerability scanner that conducts comprehensive security audits on networks and provides a framework for vulnerability management. It offers a collection of tools for vulnerability scanning, management, and reporting.

## Reporting

Vulnerability assessment reports are crucial for communicating identified risks, their severity, and recommended mitigation strategies to stakeholders. These reports typically include details about vulnerabilities found, their impact, remediation steps, and risk prioritization.
