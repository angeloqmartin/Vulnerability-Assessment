# Vulnerability Assessment

This repository aims to provide comprehensive information and resources on Vulnerability Assessment, encompassing key topics in security assessments, vulnerability scoring, essential tools like Nessus and OpenVAS, Splunk and reporting mechanisms.

## Table of Contents

1. [Security Assessments](#security-assessments)
2. [Vulnerability Scoring and Reporting](#vulnerability-scoring-and-reporting)
3. [Nessus](#nessus)
4. [OpenVAS](#openvas)
5. [Reporting](#reporting)

---

## Security Assessments

Security assessments are crucial for organizations, allowing them to identify and address vulnerabilities in their networks, systems, and applications. These assessments help in compliance evaluation, risk mitigation, and improving cybersecurity posture.

Vulnerability assessments differ from penetration tests. They focus on checklist-based evaluations and validation of critical vulnerabilities, while penetration tests involve comprehensive manual and automated techniques, showcasing real-world attack scenarios.

Regular vulnerability assessments, aligned with industry standards like GDPR or OWASP, confirm vulnerabilities without delving into advanced exploitation techniques. Organizations might choose these assessments periodically or opt for more comprehensive penetration tests to identify broader security issues.

Beyond vulnerability assessments and penetration tests, organizations might require other security assessments based on specific needs.

While vulnerability assessments are internally initiated, security audits are mandated by external entities to ensure compliance with regulations such as PCI DSS for credit card acceptance.

Conducting vulnerability assessments proactively is crucial for organizations to maintain compliance before facing surprise security audits mandated by external entities.

### Methodology

Below is a sample vulnerability assessment methodology:

8 Steps To Performing A Network Vulnerability Assessment

1. **Conduct Risk Identification And Analysis**: Identify assets that are a part of an information system.
2. **Develop Vulnerability Scanning Policies**: The policies should have an official owner and be approved by management.
3. **Identify The Type Of Scans**: Depending on the system it needs to be determined the type of scan to be preformed.
4. **Configure The Scan**: To configure a vulnerability scan define, targets, ports and protocols, etc.
5. **Perform The Scan**: Scanning tools will fingerprint the specified targets to gather basic information.
6. **Evaluate And Consider Possible Risks**: Risks associated with scan pertain mostly to the availability of the target system.
7. **Interpret The Scan Results**: Give priority to vulnerability.
8. **Create A Remediation & Mitigation Plan**: Information security staff should prioritize the mitigation of each vulnerability.

## Vulnerability Scoring and Reporting

### Common Vulnerability Scoring System (CVSS) & Common Vulnerabilities and Exposures (CVE)

In cybersecurity, determining the severity of vulnerabilities involves using standards like the [Common Vulnerability Scoring System (CVSS)](https://www.first.org/cvss/). While scanning tools automatically apply these scores, understanding the methodology behind them is crucial for manual assessments or justifications of assigned scores.CVSS is often complemented by Microsoft's DREAD, an assessment system aiding in evaluating threat severity. DREAD employs a 10-point scale, focusing on five key factors:
1. Damage Potential
2. Reproducibility
3. Exploitability
4. Affected Users
5. Discoverability

### Calculating CVSS Severity

The CVSS v3.1 calculator can be found [here](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator) and the equations can be seen defined below. 

**Base**

The Base Score is a function of the Impact and Exploitability sub score equations. Where the Base score is defined as,

    If (Impact sub score <= 0)     0 else,
    Scope Unchanged4               𝑅𝑜𝑢𝑛𝑑𝑢𝑝(𝑀𝑖𝑛𝑖𝑚𝑢𝑚[(𝐼𝑚𝑝𝑎𝑐𝑡 + 𝐸𝑥𝑝𝑙𝑜𝑖𝑡𝑎𝑏𝑖𝑙𝑖𝑡𝑦), 10])
    Scope Changed                  𝑅𝑜𝑢𝑛𝑑𝑢𝑝(𝑀𝑖𝑛𝑖𝑚𝑢𝑚[1.08 × (𝐼𝑚𝑝𝑎𝑐𝑡 + 𝐸𝑥𝑝𝑙𝑜𝑖𝑡𝑎𝑏𝑖𝑙𝑖𝑡𝑦), 10])

and the Impact sub score (ISC) is defined as,

    Scope Unchanged 6.42 × 𝐼𝑆𝐶Base
    Scope Changed 7.52 × [𝐼𝑆𝐶𝐵𝑎𝑠𝑒 − 0.029] − 3.25 × [𝐼𝑆𝐶𝐵𝑎𝑠𝑒 − 0.02]15

Where,

    𝐼𝑆𝐶𝐵𝑎𝑠𝑒 = 1 − [(1 − 𝐼𝑚𝑝𝑎𝑐𝑡𝐶𝑜𝑛𝑓) × (1 − 𝐼𝑚𝑝𝑎𝑐𝑡𝐼𝑛𝑡𝑒𝑔) × (1 − 𝐼𝑚𝑝𝑎𝑐𝑡𝐴𝑣𝑎𝑖𝑙)]

 And the Exploitability sub score is,

    8.22 × 𝐴𝑡𝑡𝑎𝑐𝑘𝑉𝑒𝑐𝑡𝑜𝑟 × 𝐴𝑡𝑡𝑎𝑐𝑘𝐶𝑜𝑚𝑝𝑙𝑒𝑥𝑖𝑡𝑦 × 𝑃𝑟𝑖𝑣𝑖𝑙𝑒𝑔𝑒𝑅𝑒𝑞𝑢𝑖𝑟𝑒𝑑 × 𝑈𝑠𝑒𝑟𝐼𝑛𝑡𝑒𝑟𝑎𝑐𝑡𝑖𝑜𝑛

**Temporal**

The Temporal score is defined as,

    𝑅𝑜𝑢𝑛𝑑𝑢𝑝(𝐵𝑎𝑠𝑒𝑆𝑐𝑜𝑟𝑒 × 𝐸𝑥𝑝𝑙𝑜𝑖𝑡𝐶𝑜𝑑𝑒𝑀𝑎𝑡𝑢𝑟𝑖𝑡𝑦 × 𝑅𝑒𝑚𝑒𝑑𝑖𝑎𝑡𝑖𝑜𝑛𝐿𝑒𝑣𝑒𝑙 × 𝑅𝑒𝑝𝑜𝑟𝑡𝐶𝑜𝑛𝑓𝑖𝑑𝑒𝑛𝑐𝑒)

**Environmental**

The environmental score is defined as,

    If (Modified Impact Sub score <= 0)     0 else,

    If Modified Scope is Unchanged          Round up(Round up (Minimum [ (M.Impact + M.Exploitability) ,10]) × Exploit Code Maturity × Remediation Level × Report Confidence)
    
    If Modified Scope is Changed            Round up(Round up (Minimum [1.08 × (M.Impact + M.Exploitability) ,10]) × Exploit Code Maturity × Remediation Level × Report Confidence)

And the modified Impact sub score is defined as,

    If Modified Scope is Unchanged 6.42 × [𝐼𝑆𝐶𝑀𝑜𝑑𝑖𝑓𝑖𝑒𝑑]
    
    If Modified Scope is Changed 7.52 × [𝐼𝑆𝐶𝑀𝑜𝑑𝑖𝑓𝑖𝑒𝑑 − 0.029]-3.25× [𝐼𝑆𝐶𝑀𝑜𝑑𝑖𝑓𝑖𝑒𝑑 × 0.9731 − 0.02] 13

Where,

    𝐼𝑆𝐶𝑀𝑜𝑑𝑖𝑓𝑖𝑒𝑑 = 𝑀𝑖𝑛𝑖𝑚𝑢𝑚 [[1 − (1 − 𝑀. 𝐼𝐶𝑜𝑛𝑓 × 𝐶𝑅) × (1 − 𝑀. 𝐼𝐼𝑛𝑡𝑒𝑔 × 𝐼𝑅) × (1 − 𝑀. 𝐼𝐴𝑣𝑎𝑖𝑙 × 𝐴𝑅)], 0.915]

The Modified Exploitability sub score is,

    8.22 × 𝑀. 𝐴𝑡𝑡𝑎𝑐𝑘𝑉𝑒𝑐𝑡𝑜𝑟 × 𝑀. 𝐴𝑡𝑡𝑎𝑐𝑘𝐶𝑜𝑚𝑝𝑙𝑒𝑥𝑖𝑡𝑦 × 𝑀. 𝑃𝑟𝑖𝑣𝑖𝑙𝑒𝑔𝑒𝑅𝑒𝑞𝑢𝑖𝑟𝑒𝑑 × 𝑀. 𝑈𝑠𝑒𝑟𝐼𝑛𝑡𝑒𝑟𝑎𝑐𝑡𝑖𝑜n
    
4 Where “Round up” is defined as the smallest number, specified to one decimal place, that is equal to or higher than its input. For example, Round up (4.02) is 4.1; and Round up (4.00) is 4.0.

### Common Vulnerabilities and Exposures (CVE)

[The Common Vulnerabilities and Exposures (CVE)](https://cve.mitre.org) serves as a comprehensive repository of security issues. Each security concern is assigned a unique CVE ID by the CVE Numbering Authority (CNA) to ensure standardized identification of vulnerabilities or exposures discovered by researchers.

A CVE entry comprises vital details regarding a vulnerability or exposure, including descriptive information and references relevant to the issue. This detailed information empowers an organization's IT team to comprehend the potential impact of a problem on their environment.

Assigning a CVE ID to a vulnerability follows specific criteria:

- The vulnerability must be independently fixable.
- It should impact a single codebase.
- The issue needs acknowledgment and documentation by the relevant vendor.

Stages of Obtaining a CVE

**Stage 1: Identify if CVE is Required and Relevant**
-  Identify if the issue found is a vulnerability. According to the CVE Team, "A vulnerability in the context of the CVE Program is indicated by code that can be exploited, resulting in a negative impact to confidentiality, integrity, OR availability, and that requires a coding change, specification change, or specification deprecation to mitigate or address." Additionally, research should verify there is not a CVE ID already in the CVE database.

**Stage 2: Reach Out to Affected Product Vendor**
-  A researcher should ensure they have made a good faith effort to contact a vendor directly. Researchers can reference CVE's [Documents on Disclosure Practices](https://www.cve.org/ReportRequest/ReportRequestForNonCNAs) for additional information.

**Stage 3: Identify if Request Should Be For Vendor CNA or Third Party CNA**
-  If a company is a part of participating CNA's, they can assign a CVE ID for one of their products. If the issue is for a participating CNA, researchers can contact the appropriate CNA organization [here](https://www.cve.org/ReportRequest/ReportRequestForNonCNAs). If the vendor is not a participating CNA, a researcher should attempt to reach out to the vendor's third-party coordinator.

**Stage 4: Requesting CVE ID Through CVE Web Form**
-  The CVE Team has a form that can be filled out online [here](https://cveform.mitre.org) if the methods above do not work for CVE requests.

**Stage 5: Confirmation of CVE Form**
-  Upon submitting the CVE Web Form mentioned in Stage 4, an individual will receive a confirmation email. The CVE team will contact the requestor if any additional information is required.

**Stage 6: Receival of CVE ID**
-  Upon approval, the CVE Team will notify the requestor of a CVE ID if the affected product's vulnerability is confirmed. Please note that the CVE ID is not public yet at this stage.

**Stage 7: Public Disclosure of CVE ID**
-  CVE IDs can be announced to the public as soon as appropriate vendors and parties are aware of the issue to prevent duplication of CVE IDs. This stage ensures that all associated parties are aware of the problem before being publicly disclosed.

**Stage 8: Announcing the CVE**
-  The CVE Team asks researchers who are sharing multiple CVEs to ensure each CVE indicates the different vulnerabilities. Additional information can be found [here](https://www.cve.org/ReportRequest/ReportRequestForNonCNAs).

**Stage 9: Providing Information to The CVE Team**
-  At this stage, the CVE Team asks that the researcher help provide additional information to be used in the official CVE listing on the website. The U.S. [National Vulnerability Database (NVD)](https://nvd.nist.gov) maintains this information online in their database as well.

## Nessus

Nessus Overview
[Nessus](https://www.tenable.com/products/nessus)  stands as a widely recognized vulnerability scanner, proficient in detecting vulnerabilities, misconfigurations, and security issues across networks and systems. Its comprehensive scanning capabilities generate detailed reports, facilitating efficient vulnerability management and remediation.

Downloading Nessus
To acquire Nessus, you can visit its [Download Page](https://www.tenable.com/downloads/nessus?loginAttempted=true) and obtain the appropriate binary for your system. After downloading the software, proceed to the Activation Code Page to request a Nessus Activation Code for activation.

You can also download by curl:

```console
curl --request GET \
  --url 'https://www.tenable.com/downloads/api/v2/pages/nessus/files/Nessus-10.6.4-ubuntu1804_aarch64.deb' \
  --output 'Nessus-10.6.4-ubuntu1804_aarch64.deb'
```

**Installing Package**

```console
$ sudo dpkg -i Nessus-10.6.4-ubuntu1804_aarch64.deb
```

Note: You will install the latest version and the one for your platform

**Start the Nessus Service:**

```consol
$ sudo systemctl start nessusd.service
```

https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/63392876-09d4-4f19-b6a2-d8555b5b5be4

Check the service has started:
```consol
$ sudo systemctl status nessusd.service
```

**Accessing Nessus**

To access Nessus, follow these steps:

1. Go to **https://localhost:8834**.
2. Choose the desired version of Nessus.
3. Enter the provided activation code.
4. Create a user account with a strong password.
5. Once completed, the plugins will begin compiling. Proceed to create scans, configure scan policies, set up plugin rules, and customize settings.

**Example Scan Configuration**

View an example of configuring a Basic Nessus scan targeting a Windows system at IP 172.16.16.100 scanning all ports here.

https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/758d03a1-5e15-492b-b20c-f581d5783bc0

While your scan is in progress, you can access a real-time display showing vulnerabilities being added and access additional details about those vulnerabilities, as illustrated below:

https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/353eb453-251b-4310-9765-a097a850967b

You will get a similiar report that shows Host, Vulnerbilites, Remidations, Top Threats, History

<img width="995" alt="Screenshot 2023-12-24 at 8 45 51 PM" src="https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/183d9142-336d-4ded-a9ab-757fa74ca1ea">
<br>
<br>

**Available Scan Types**

Nessus offers various scan types like Basic Network Scans, Advanced Scans, Malware Scans, Web Application Tests, and scans for specific CVEs and audit & compliance standards. You can find descriptions for each scan type [here](https://docs.tenable.com/nessus/Content/ScanAndPolicyTemplates.htm).

**Advanced Scan Options**

On the Advanced tab, safe checks should be enabled by default to prevent negative impacts on targeted devices or networks. It also offers options to manage network congestion, stop scanning unresponsive hosts, and scan target IPs in random order.

**Scan Policies**

Nessus allows creating custom scan policies to define specific scan options, saving configurations, and using them as templates for new scans. This feature enables tailored scans for various scenarios, such as slower, more evasive scans, web-focused scans, or client-specific scans using different credentials.

**Credential-based Scanning**

Nessus supports credentialed scanning with support for LM/NTLM hashes, Kerberos, password authentication, SSH, public keys, certificates, and more for both Windows and host-based authentication.

**Nessus Reports**

After completing a scan, Nessus enables report export in .pdf, .html, or .csv formats. The .pdf and .html options offer an Executive Summary or a customizable report.

-  Executive Summary: Provides a list of hosts, total vulnerabilities per host, and a "Show Details" option revealing severity, CVSS score, plugin number, and issue names. Plugin numbers link to the complete writeup in the Tenable plugin database. The PDF format ensures easy sharing.
-  Customized Reports: The CSV report selection allows specific column export, useful for importing into other tools like Splunk. This feature facilitates document sharing among internal stakeholders responsible for remediation or data analysis.

You can "Generate CSV Report" and select which cloumns to include as shown below:

<img width="1194" src="https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/651946f6-6c8e-4620-a3ba-49b0acb14805">

## OpenVAS

[OpenVAS](https://www.openvas.org/) (Open Vulnerability Assessment System) is an open-source vulnerability scanner designed for comprehensive security audits on networks and offers a framework for vulnerability management. It provides a suite of tools for vulnerability scanning, management, and reporting.

**Installing OpenVAS**

To install the OpenVAS tool, use the following commands:
```console
$ sudo apt-get install gvm && openvas
```

Begin the installation process, we can run the following command below:
```console
$ gvm-setup
```

**Starting OpenVAS**

Initiate OpenVAS by executing the following command in the terminal:
```
$ gvm-start
```

**Accessing OpenVAS**

Access OpenVAS via the web browser using https://< IP >:8080 and entering your OpenVAS credentials. For example, "https://10.129.202.120:8080/" is used:

<img width="713" alt="Screenshot 2023-12-24 at 9 37 51 PM" src="https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/2eb19349-d53d-46ec-829e-91548716f2e8">
<br>
<br>

**Performing a Basic Scan**

Perform a Basic OpenVAS scan targeting a Windows system at IP 172.16.16.100 scanning all ports by navigating to Scans > New Task.
<img width="1440" alt="Screenshot 2023-12-24 at 9 46 34 PM" src="https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/62ec4c42-6a54-4b0c-b325-573301a6fa08">

<img width="797" alt="Screenshot 2023-12-24 at 9 53 50 PM" src="https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/d1d3a275-1eae-452a-901f-336d6d33f104">

OpenVAS scan results display various areas for review such as Results, Host, Ports, Applications, Operating System, CVEs, and more.

https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/62fcb9a8-566d-4c8b-9920-5e9ac69bf959

To download the scan report, navigate to Scans > Reports, click on the downloads icon, and choose the desired report format for export.

https://github.com/angeloqmartin/Vulnerability-Assessment/assets/37564935/9f1bf4dc-b7fa-4453-a661-658d718aca34

The results can be exported in XML formate and use the openvasreporting which  offers various options when generating output. 

This command will use the standard option and  generate an Excel file:
```console
python3 -m openvasreporting -i report-2bf466b5-627d-4659-bea6-1758b43235b1.xml -f xlsx
```

## Splunk

[Splunk](https://www.splunk.com/) is a powerful data analysis and visualization tool commonly used for log management, monitoring, and security information and event management (SIEM). It aggregates, correlates, and analyzes high volumes of data generated by various sources, enabling insights into security incidents, operational issues, and more.

### Installing Splunk

To install Splunk, follow the steps provided on their [official download page](https://www.splunk.com/en_us/download/splunk-enterprise.html).

### Getting Data into Splunk

Once installed, access Splunk via a web browser at `https://<Splunk_server_IP>:8000`. Follow the setup wizard instructions to create an account and set up the initial configurations.

### Splunk Features

- **Data Ingestion:** Splunk allows the ingestion of various data types including logs, metrics, and events from diverse sources.
- **Search and Analysis:** Perform searches using SPL (Splunk Processing Language) to analyze data and create visualizations.
- **Dashboards and Visualizations:** Create custom dashboards and visualizations to represent data trends and insights.
- **Alerting and Monitoring:** Set up alerts based on predefined criteria and monitor systems in real-time.
- **Apps and Add-ons:** Expand Splunk's functionality using numerous apps and add-ons available in the Splunkbase.

### Using Splunk for Security and Monitoring

Splunk can be used for security purposes such as:

- **Threat Detection:** Monitor and detect security threats in real-time by analyzing log data.
- **Incident Response:** Investigate security incidents and track their resolution process.
- **Compliance Management:** Assist in compliance adherence by analyzing logs for regulatory requirements.

### Additional Resources

For detailed documentation, tutorials, and community support, refer to the [Splunk Documentation](https://docs.splunk.com/Documentation) and [Splunk Answers](https://community.splunk.com/).


## Reporting

Vulnerability assessment reports are crucial for communicating identified risks, their severity, and recommended mitigation strategies to stakeholders. These reports typically include details about vulnerabilities found, their impact, remediation steps, and risk prioritization.
